<!DOCTYPE html>
<html lang="ja">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PSDTool Reference Manual</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Roboto+Condensed:700'>
<link href="css/main.css" rel="stylesheet">

<body>
	<div id="manual" class="container">
		<h1>
			PSDTool Reference Manual
			<small>取扱説明書</small>
		</h1>
		<ol>
			<li>
				<a href="#about">PSDTool とは？</a>
				<ol>
					<li><a href="#about-movie">PSDTool 紹介動画</a></li>
				</ol>
			</li>
			<li><a href="#env">動作環境</a></li>
			<li>
				<a href="#feature">機能の説明</a>
				<ol>
					<li><a href="#feature-options">ファイルを開く前のオプション</a></li>
					<li><a href="#feature-mainview">メイン画面</a></li>
					<li><a href="#feature-layer-tree">レイヤーツリー画面 / シンプルビュー画面</a></li>
					<li><a href="#feature-favview">お気に入り編集画面</a></li>
					<li><a href="#feature-filter">フィルター編集画面</a></li>
					<li><a href="#feature-faview">シンプルビュー</a></li>
				</ol>
			</li>
			<li>
				<a href="#supported-filetype">読み込める PSD ファイル</a>
				<ol>
					<li><a href="#supported-filetype-zip">ZIP ファイルの読み込み</a></li>
					<li><a href="#supported-filetype-direct">ダイレクト読み込み</a></li>
				</ol>
			</li>
			<li>
				<a href="#original-feature">独自拡張機能</a>
				<ol>
					<li><a href="#original-feature-asterisk">ラジオボタン化「*」</a></li>
					<li><a href="#original-feature-exclamation">強制表示化「!」</a></li>
					<li><a href="#original-feature-flip">反転表示用レイヤー「:flipx」「:flipy」「:flipxy」</a></li>
				</ol>
			</li>
			<li><a href="#pfv-spec">PFV ファイルについて</a></li>
			<li><a href="#changes">変更履歴</a></li>
		</ol>

		<h2 id="about">PSDTool とは？</h2>
		<p><img src="img/about.png" width="346" height="265" class=" psdtool-thumb" alt="PSDTool のスクリーンショット"></p>
		<p>
			PSDTool は Photoshop 形式(*.psd) のファイルをブラウザで読み込んでレイヤーの表示／非表示を切り替えたり、合成された画像に名前を付けて保存したりできるツールです。
			<br><strong>読み込む PSD ファイルはサーバーには一切送信されず完全にブラウザだけで処理される</strong>ため、プライベートな用途にも使用できます。
		</p>
		<p>
			このツールは「イラストを描く人がレイヤーの表示／非表示を切り替えた様々なパターンを PNG で書き出したものを配布する」といった時間の浪費と手間を減らすために、 また配布されているイラストを利用したい人がソフトウェアを何も用意しなくても最新のブラウザさえあれば PSD ファイルを扱えるようにすることを目的に作りました。
		</p>
		<p>
			Photoshop 形式は sai、CLIP STUDIO PAINT、openCanvas、Krita、メディバンペイント、FireAlpaca など様々なペイントソフトで保存可能な共通の保存フォーマットです。
			<br>これを機に、是非 Photoshop 形式での配布を検討してみてください。
		</p>
		<h3 id="about-movie">PSDTool 紹介用動画</h3>
		<p>PSDTool の使い方を紹介する動画があります。</p>
		<p>
			<a target="_blank" href="http://www.nicovideo.jp/watch/sm28712861">
				<img src="img/movie-thumb.jpg" width="130" height="100" class="psdtool-thumb" alt=""> 立ち絵支援ツール PSDTool の使い方
			</a>
		</p>
		<h2 id="env">動作環境</h2>
		<p>
			Microsoft Edge / Google Chrome / Mozilla Firefox 上でブラウザ画面サイズ 1024x600 以上を基準に動作確認しています。
			<br>Mac を持っていないので Apple Safari ではテストしていません。
		</p>
		<p>
			ブラウザは常に最新版をお使いください。
		</p>
		<h3>Chrome で絵が出なくなったりする場合</h3>
		<p>
			chrome://flags/ をブラウザで開いて「アクセラレーションによる 2D キャンバス表示」を無効にしてみてください。
			<br> この設定によって症状が改善される場合があります。
		</p>
		<h2 id="feature">機能の説明</h2>
		<ol>
			<li><a href="#feature-options">ファイルを開く前のオプション</a></li>
			<li><a href="#feature-mainview">メイン画面</a></li>
			<li><a href="#feature-layer-tree">レイヤーツリー画面 / シンプルビュー画面</a></li>
			<li><a href="#feature-favview">お気に入り編集画面</a></li>
			<li><a href="#feature-filter">フィルター編集画面</a></li>
		</ol>
		<h3 id="feature-options">ファイルを開く前のオプション</h3>
		<p>ファイルを開く際に、いくつかのオプションが設定可能です。</p>
		<dl>
			<dt>自動トリミング</dt>
			<dd>
				<p>
					自動トリミングを有効にすると PSD ファイルに存在する全てのレイヤーを表示したとしても使われることがない、完全な余白のみを削ります。
					<br>ある瞬間に表示している内容でトリミングするわけではないので、「ウサギの耳」「翼」のように一部または全部の方向へ突出するようなレイヤーが存在する場合、その分の余白は常に確保されます。
				</p>
				<p><img src="img/trim-sample.png" width="400" height="340" class="psdtool-thumb" alt="自動トリミングの使用サンプル"></p>
				<p>
					上記サンプルでは、自動トリミングありの場合は左右はギリギリまでカットされ、上部は「左向き用・主線」レイヤーを表示するための余白が数ピクセルだけ残っています。
				</p>
				<p>
					なお縮小する場合、縮小後のサイズを例えば 320px としても上記サンプルのように余白の有無によって画像の縮小率が変わってきます。 余白を上手く使って複数の PSD ファイル間で同程度のサイズ感になるよう整えられている場合などもあるため、自動トリミングの使用には注意が必要です。
				</p>
			</dd>
			<dt>独自拡張機能を無効化</dt>
			<dd>
				<p>
					独自拡張機能を無効化は PSDTool での使用を想定していない PSD ファイルを読む際に使う機能で、<a href="#original-feature">PSDTool が持つ独自拡張機能</a> が認識されないようにします。 レイヤー名が独自拡張機能と衝突してしまい、レイヤー表示切替のチェックボックスがラジオボタンになったり消えてしまっている場合に有用です。
				</p>
			</dd>
		</dl>
		<h3 id="feature-mainview">メイン画面</h3>
		<p>ファイルを開くと画面には以下の様なインターフェイスが現れます。</p>
		<p><img src="img/head.png" width="769" height="180" class="psdtool-thumb" alt="PSDTool の画面上部にあるインターフェイスのスクリーンショット"></p>
		<dl>
			<dt>1. タブ</dt>
			<dd>
				<p><a href="#feature-layer-tree">レイヤーツリー画面</a>と<a href="#feature-favview">お気に入り編集画面</a>を切り替えるためのタブです。</p>
			</dd>
			<dt>2. レイヤーツリー</dt>
			<dd>
				<p>
					タブで「レイヤー」が選ばれている時は<a href="#feature-layer-tree">レイヤーツリー画面 / シンプルビュー画面</a>、「お気に入り」が選ばれている時は<a href="#feature-favview">お気に入り編集画面</a>が表示されます。
				</p>
			</dd>
			<dt>3. 反転</dt>
			<dd>
				<p>
					&#x21c4; を押すと左右、&#x21c5; を押すと上下に画像を反転します。文字やアクセサリー、髪型や服の装飾などのように、反転すると問題がある場合もあるため使用には注意が必要ですが、<a href="#original-feature-flip">PSD ファイル側で独自拡張機能</a>を使って対策されている場合は正しく表示される場合もあります。
				</p>
			</dd>
			<dt>4. 縮小</dt>
			<dd>
				<p>
					読み込んだ画像が大きすぎる場合、ここで保存前に縮小することができます。 縦か横のどちらかの最大ピクセル数を指定すると、その大きさを超えないように必要に応じて縮小されます。この設定によって元のサイズより画像が拡大されることはありません。
				</p>
			</dd>
			<dt>5. PNG で保存</dt>
			<dd>
				<p>
					画像を通し番号付きで保存するための機能です。 スクリーンショットのように入力欄がそれぞれ「im5467479_」「0」の状態で「.png」ボタンを押すと「im5467479_0000.png」というファイル名で保存され、そのまま同じボタンを押す度に数字が足されていきます。
				</p>
				<p>
					数字の入力欄を空欄にすることで、通し番号が付かない、ただの画像保存ボタンとしても利用可能です。
				</p>
			</dd>
			<dt>6. 合成結果プレビュー / お気に入りプレビュー</dt>
			<dd>
				<p>
					合成結果プレビューには現在のレイヤー選択状態が表示されます。
				</p>
				<p>
					また、お気に入りを選択した時は一時的にお気に入りの内容を表示するお気に入りプレビューに変化します。 お気に入りプレビューモードはレイヤータブに切り替えたりすることで解除されます。
				</p>
			</dd>
		</dl>

		<h3 id="feature-layer-tree">レイヤーツリー画面 / シンプルビュー画面</h3>
		<p>
			タブで「レイヤー」を選ぶとレイヤー表示構成の切り替えができるレイヤーツリー画面またはシンプルビュー画面が表示されます。
			<br>シンプルビュー画面を使うためには<a href="#feature-faview">お気に入りを適切に組み立てる</a>必要があり、使用できない状態の時は「シンプルビューに切り替え」ボタンも表示されません。
		</p>
		<p><img src="img/layertree.png" width="512" height="420" class="psdtool-thumb" alt="レイヤーツリー画面のスクリーンショット"></p>
		<p>
			レイヤーツリー画面ではチェックボックスやラジオボタンの切り替えで、シンプルビュー画面ではセレクトボックスやスライダーによる切り替えによって、画像のレイヤー表示構成を変更することができます。
		</p>

		<h3 id="feature-favview">お気に入り編集画面</h3>
		<p>タブで「お気に入り」を選ぶとレイヤー表示構成の保存や読み込みができるお気に入り編集画面が表示されます。</p>
		<p><img src="img/fav.png" width="350" height="263" class="psdtool-thumb" alt="お気に入り編集画面のスクリーンショット"></p>
		<p>作成したお気に入りはシングルクリックでプレビュー、ダブルクリックでレイヤー一覧に読み込むことができます。その他、Shift や Ctrl(Option) を押しながらクリックで複数選択や、ドラッグで項目の入れ替え、Ctrl(Option) を押しながらドラッグでコピーなどもできます。</p>
		<dl>
			<dt><span class="glyphicon glyphicon-star"></span> 現在のレイヤー表示をお気に入りに追加（Ctrl + B / Option + B）</dt>
			<dd>
				<p>
					現在レイヤータブで選択している構成をお気に入りに追加します。
				</p>
				<p>
					ショートカットキーを使用するとレイヤータブを表示していてもお気に入りに追加することができます。
				</p>
			</dd>
			<dt><span class="glyphicon glyphicon-folder-open"></span> 新規フォルダー（Ctrl + D / Option + D）</dt>
			<dd>
				<p>
					項目の整理に利用可能なフォルダーを追加します。
				</p>
			</dd>
			<dt><span class="glyphicon glyphicon-pencil"></span> 名前の変更（F2）</dt>
			<dd>
				<p>
					項目の名前を変更します。
				</p>
			</dd>
			<dt><span class="glyphicon glyphicon-remove"></span> 削除</dt>
			<dd>
				<p>
					項目を削除します。削除の際には確認ダイアログはなく、元に戻す手段も用意されていないので気をつけて使用する必要があります。
				</p>
			</dd>
			<dt><span class="glyphicon glyphicon-menu-hamburger"></span> → <span class="glyphicon glyphicon-folder-open"></span> 一括フォルダー作成</dt>
			<dd>
				<p>
					複数のフォルダーを一気に作成するための機能です。フォルダー名を改行で区切って入力することで、効率的に複数のフォルダーを作成することができます。
				</p>
			</dd>
			<dt><span class="glyphicon glyphicon-menu-hamburger"></span> → <span class="glyphicon glyphicon-pencil"></span> 一括名前変更</dt>
			<dd>
				<p>
					お気に入りの項目の名前を効率的に変更するための機能です。変更したい項目が複数ある場合、こちらを使うことで作業効率が改善されるかもしれません。
				</p>
				<p>
					入力欄を空欄にして名前の変更をすると自動的に連続した番号で埋めていく機能もあり、ダイアログの下に桁数や開始番号を指定する設定項目があります。
				</p>
			</dd>
			<dt><span class="glyphicon glyphicon-menu-hamburger"></span> → <span class="glyphicon glyphicon-th-list"></span> シンプルビュー設定</dt>
			<dd>
				<p>
					<a href="#feature-faview">シンプルビュー</a>に関する設定項目があるダイアログが表示されます。
				</p>
				<dl>
					<dt>シンプルビューが使えるお気に入りデータを読み込んだ時の動作</dt>
					<dd>
						<p>
							お気に入りを読み込んだ時に、シンプルビューが使える場合に振る舞いを変えることができます。
						</p>
					</dd>
				</dl>
			</dd>
			<dt><span class="glyphicon glyphicon-menu-hamburger"></span> → <span class="glyphicon glyphicon-open-file"></span> インポート</dt>
			<dd>
				<p>
					選ぶとダイアログが表示されます。
				</p>
				<dl>
					<dt>PFV ファイルをインポート</dt>
					<dd>
						<p>
							選択された PFV ファイルを読み込みます。
						</p>
						<p>
							このダイアログを開かなくても、PSD ファイルを開く際に PFV ファイルも一緒にドラッグ＆ドロップしたり、お気に入りタブ内のお気に入りツリーに PFV ファイルをドラッグ＆ドロップすることで読み込むこともできます。できますが、マニュアルを読まない人は恐らく PFV ファイルを開くためにインポート内を探しに来ると思ったので、ここにも用意してある、というわけなんですよ。
						</p>
					</dd>
					<dt>最近使ったお気に入りからインポート</dt>
					<dd>
						<p>
							ブラウザに自動保存されたお気に入りからインポートします。手動でインポートしなくても PSD ファイルを読み込んだ時に、読むべき PFV ファイルが特になければこの中からひとつ自動的に読み込まれます。
						</p>
						<p>
							青い項目は同じ画像から作成されたお気に入りで、読み込んで利用できることが期待できます。
							<br>白い項目は読み込んでも画像のレイヤー構造の違いにより利用できない可能性もありますが、PFV ファイルにエクスポートし直すことはできます。
						</p>
						<p>
							ここに現れるデータはブラウザのデータ削除などにより意図しないタイミングで読めなくなる可能性があるため、重要なデータは別途保存しておくことを推奨します。
						</p>
					</dd>
				</dl>
			</dd>
			<dt><span class="glyphicon glyphicon-menu-hamburger"></span> → <span class="glyphicon glyphicon-save-file"></span> エクスポート</dt>
			<dd>
				<p>
					選ぶとダイアログが表示されます。
				</p>
				<dl>
					<dt>PFV ファイルをエクスポート</dt>
					<dd>
						<p>
							お気に入りの情報を PFV(Psdtool FaVorites) ファイルに書き出します。
						</p>
						<p>
							書き出した PFV ファイルはあとで自分でインポートして使用したり、PFV ファイルを配布して他人に利用してもらうこともできます。
						</p>
						<p>
							また PFV ファイルは UTF-8 のテキストファイルなので、テキストエディタで開いて直接編集することもできます。
						</p>
						<p>
							PSD ファイル / PFV ファイル / テキストファイルの3つを ZIP ファイルに入れておき、解凍せずに直接 PSDTool で開くと全てを読み込むことができます。
							<br>この仕組みにより、ZIP ファイルを PSDTool で読み込むだけでおすすめのレイヤー表示構成を最初からお気に入りに読み込んだ状態にもできます。
						</p>
					</dd>
					<dt>画像を ZIP ファイルでエクスポート</dt>
					<dd>
						<p>
							お気に入りのすべての項目を PNG ファイルで ZIP ファイルに書き出すことができます。 書き出す際には現在の反転や縮小の設定が適用されます。
						</p>
						<p>
							ZIP ファイルには PFV ファイルも一緒に書き出されており、これを読み込むことで左右反転や縮小率を変えて書き出し直したり、お気に入りに更に項目を追加したい場合などにも利用できます。
						</p>
						<p>
							処理速度を確保するため ZIP ファイルは無圧縮で作成されます。 もし ZIP ファイルで書き出し可能な容量やファイル数を超過する場合は、自動的に ZIP64 フォーマットで書き出されます。
						</p>
						<p>なお、この項目は右端の ▼ をクリックすることで更に詳細な書き出しオプションを選ぶことができます。</p>
						<dl>
							<dt>フィルタリングされた項目は残ったパーツのみを出力</dt>
							<dd>
								通常のエクスポートではフィルタリングされたお気に入りは「お気に入りプレビュー」で表示される内容と同じもの（つまり「レイヤータブの選択状態」＋「フィルタリングされたお気に入りの内容」）を出力しますが、こちらからエクスポートした場合は「フィルタリングされたお気に入りの内容」のみを出力します。
								<br>そのため、例えば目のパーツ以外をフィルタリングしているお気に入りは目のパーツのみが画像として出力されます。
							</dd>
						</dl>
					</dd>
					<dt>シンプルビューの全パターンを ZIP ファイルでエクスポート</dt>
					<dd>
						<p>
							シンプルビューの組み合わせで表現可能な全ての構成を PNG ファイルで ZIP ファイルに書き出すことができます。書き出す際には現在の反転や縮小の設定が適用されます。
						</p>
						<p>
							ただし、「目」を変えるためのセレクトボックスが複数ある場合のように、全てのスライダーが同じ位置にあっても最後に触った項目によって結果が異なるような構成は正しく出力されません。
						</p>
						<p>
							処理速度を確保するため ZIP ファイルは無圧縮で作成されます。 もし ZIP ファイルで書き出し可能な容量やファイル数を超過する場合は、自動的に ZIP64 フォーマットで書き出されます。
						</p>
						<p>このボタンを押す場合はサブメニューから書き出し構造を選択する必要があります。</p>
						<dl>
							<dt>パーツ名あり / 入れ子</dt>
							<dd>
								例: <samp>キャラ名\眉-困り\目-にっこり\口-笑い.png</samp>
							</dd>
							<dt>パーツ名あり / フラット</dt>
							<dd>
								例: <samp>キャラ名_眉-困り_目-にっこり_口-笑い.png</samp>
							</dd>
							<dt>パーツ名なし / 入れ子</dt>
							<dd>
								例: <samp>キャラ名\困り\にっこり\笑い.png</samp>
							</dd>
							<dt>パーツ名なし / フラット</dt>
							<dd>
								例: <samp>キャラ名_困り_にっこり_笑い.png</samp>
							</dd>
						</dl>
					</dd>
					<dt>レイヤー構造をテキストファイルでエクスポート</dt>
					<dd>
						<p>
							PSD ファイルのレイヤー構造をタブで整形された文字コード UTF-8 改行コード &#39;\n&#39; のテキストファイルとして、概ね以下の様な形で出力します。
						</p>
						<pre>!眉
	*(`・ω・´)
	*(´･ω･`)
	*普通
!くち
	*あー！
	*ふぇー
	*ムー
	*ワ
!目
	*つぶり
	*ぐるぐる
	*にっこり
	*通常
!下地
	*左向き用・主線
	*右向き用・主線</pre>
						<p>
							レイヤー名をテキストでコピーしたい場合など、レアケースで役に立ちます。
						</p>
					</dd>
				</dl>
			</dd>
			<dt id="generate-items-from-radios">ラジオグループからお気に入りを自動生成（Shift + Ctrl + G / Shift + Option + G）</dt>
			<dd>
				<p>
					これはレイヤー一覧でラジオボタンをクリックした後にショートカットキーを押すことで使用可能な機能で、ラジオボタンで選択可能な項目の全てのパターンでお気に入りを自動生成します。
				</p>
			</dd>
		</dl>
		<h3 id="feature-filter">フィルター編集画面</h3>
		<p><img src="img/filter.png" width="620" height="320" class="psdtool-thumb" alt="フィルター編集画面のスクリーンショット"></p>
		<p>お気に入りで作成したフォルダーをダブルクリックすると、フィルター設定画面が現れます。</p>
		<p>フィルター機能を有効にすると、お気に入りを読み込む際に現在のレイヤー表示に対しお気に入りを一部にだけ適用することができるようになります。</p>

		<p>フィルター機能が有効になっているフォルダーはアイコンが <span class="glyphicon glyphicon-folder-open"></span> から <span class="glyphicon glyphicon-filter"></span> に変わり、そのフォルダー以下にあるお気に入りはチェックが入っているレイヤーの項目だけを読み込むように変わります。</p>

		<h4>使用例</h4>
		<p>
			<iframe width="853" height="480" class="embed-responsive-item" src="https://www.youtube-nocookie.com/embed/-L_IzlyGxNM?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe>
		</p>
		<p>
			上記の例では元々は眉、目、口がそれぞれ異なるお気に入りが、フィルターを指定することにより口だけの変化に変わる様子を示しています。
			<br>また、口以外は元々の状態を維持しようとするため、レイヤー一覧で他のパーツを変更すればその状態から口だけを変更をすることができます。
		</p>
		<p>この例の場合は直接口レイヤーを切り替えることと本質的な違いがありませんが、例えば複数のパーツの切り替えが必要な服装や、口だけではなく表情全体など大きな単位でフィルターを有効にすると、現在の服装やポーズを維持したまま表情だけをお気に入りから読み込むような使い方ができます。</p>

		<h3 id="feature-faview">シンプルビュー</h3>
		<p>
			シンプルビューは<a href="#feature-layer-tree">レイヤーツリー</a>でチェックボックスやラジオボタンを操作する代わりに、セレクトボックスやスライダーから項目を選んで組み合わせられる画面です。シンプルビューを有効化するためには、<a href="#feature-favview">お気に入り</a>にシンプルビュー用の項目を作成する必要があります。
		</p>
		<h4>シンプルビューを有効化する方法</h4>
		<p><img src="img/faview.png" width="820" height="600" class="psdtool-thumb" alt="シンプルビューを有効化する方法の解説"></p>
		<dl>
			<dt>1. シンプルビューの起点となる親のフォルダーの名前の先頭に「*」半角アスタリスクをつける</dt>
			<dd>
				<p>このフォルダーの中がシンプルビュー表示用であることを指定します。</p>
			</dd>
			<dt>2. <a href="#feature-filter">フィルター機能</a>を使ってパーツ単位でお気に入りをまとめる</dt>
			<dd>
				<p>
					フォルダーを作り、その中にパーツを切り替えたお気に入りを一つ以上作成して、そのフォルダーでフィルター機能を有効化します。フィルター機能を有効化していない場合、シンプルビューの選択肢として現れません。
				</p>
				<p>
					お気に入りの登録順はそのまま選択項目の順番として使用されます。また、選択項目内で一番上にある項目は一番最初にシンプルビューを開いた時のデフォルト項目として使用されます。
				</p>
				<p>
					必要であればフォルダーはもっと階層を深くすることもできますが、深くなると利用する時の手間が増える可能性もあります。
				</p>
			</dd>
			<dt>3. レイヤータブに画面を切り替える</dt>
			<dd>
				<p>
					1 の手順が完了した時点で、レイヤータブに切り替えると「シンプルビューに切り替え」のボタンが表示されるようになります。
					<br>2 の手順が完了していれば、作成した項目がシンプルビューでの選択項目として現れるようになります。
					<br>なお、お気に入りを１つしか入れていないフォルダーがある場合、その項目はシンプルビュー上で変更できないためグレーアウト状態で表示されます。
				</p>
			</dd>
		</dl>
		<p><img src="img/faview-active.png" width="226" height="518" class="psdtool-thumb" alt="シンプルビューを有効化した時のスクリーンショット"></p>
		<p>これが上記サンプルで作成したお気に入りのシンプルビュー表示例です。それぞれの各項目の一番上にあったものがデフォルトの表示項目として表示され、「体」に関してはお気に入りがひとつしか登録されていないためグレーアウトされています。</p>
		<p>お気に入り内にシンプルビュー用の親フォルダーが複数ある場合、一番上の選択項目で選んで切り替えることができるようになります。</p>

		<h4>使用例</h4>
		<p>
			<iframe width="853" height="480" class="embed-responsive-item" src="https://www.youtube-nocookie.com/embed/F1qPRdpZHd4?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe>
		</p>
		<p>実際にシンプルビュー用のお気に入りデータを作成する例です。お気に入りデータの登録には<a href="#generate-items-from-radios">ラジオグループからお気に入りを自動生成</a>を使用していますが、使用しなくてもデータの作成は可能です。</p>

		<h2 id="supported-filetype">読み込める PSD ファイル</h2>
		<p>PSDTool は「最大公約数的な PSD ファイル読み込みツール」というのを目標に開発しているため、Photoshop 以外のソフトでも頻繁に使われるであろう機能を優先的に実装しています。</p>
		<ul>
			<li>カラーモードは「RGB カラー（8bit/チャンネル）」にのみ対応しています。</li>
			<li>グループレイヤー（フォルダーレイヤー）に対応しています。</li>
			<li>クリッピングマスク、レイヤーマスクに対応しています。</li>
			<li>
				レイヤーの合成モードは以下のものに対応しています。
				<ul>
					<li>通過（グループレイヤーのみ）</li>
					<li>通常</li>
					<li>比較（暗）</li>
					<li>乗算</li>
					<li>焼き込みカラー</li>
					<li>焼き込み（リニア）</li>
					<li>カラー比較（暗）</li>
					<li>比較（明）</li>
					<li>スクリーン</li>
					<li>覆い焼きカラー</li>
					<li>覆い焼き（リニア）</li>
					<li>カラー比較（明）</li>
					<li>オーバーレイ</li>
					<li>ソフトライト</li>
					<li>ハードライト</li>
					<li>ビビッドライト</li>
					<li>リニアライト</li>
					<li>ピンライト</li>
					<li>ハードミックス</li>
					<li>差の絶対値</li>
					<li>除外</li>
					<li>減算</li>
					<li>除算</li>
					<li>色相</li>
					<li>彩度</li>
					<li>カラー</li>
					<li>輝度</li>
				</ul>
			</li>
			<li>テキストレイヤー、調整レイヤー、シェイプレイヤーなどには対応していません。</li>
		</ul>
		<h3 id="supported-filetype-zip">ZIP ファイルの読み込み</h3>
		<p>
			ZIP ファイルに格納されている PSD ファイルは、ファイルを取り出さずにそのまま開くことができます。
		</p>
		<ul>
			<li>複数の PSD ファイルが ZIP ファイル内に存在する場合、最初に見つかったものが読み込まれます。</li>
			<li>
				PFV ファイルが ZIP ファイル内に存在する場合、自動的にお気に入りに読み込まれます。
				<br>ただし、その PFV ファイルより更新日時が新しいお気に入りデータがブラウザに保存されているときは、ブラウザのものが優先されます。
			</li>
			<li>
				テキストファイルが ZIP ファイル内に存在する場合、レイヤー一覧の一番上にテキストファイル表示用のボタンが現れます。
				<br><a href="#feature-faview">シンプルビュー</a>が使えるお気に入りデータが一緒に読み込まれている場合はテキストを自動的に表示することもできます。
			</li>
		</ul>
		<h3 id="supported-filetype-direct">ダイレクト読み込み</h3>
		<p>
			以下に示す条件のいずれかを満たすことで、PSDTool はあなたのサイトにあるファイルを読むことができます。
			<br>あなたのサイトに配置された配布用の ZIP ファイルをこの仕組みで直接開くこともできます。
		</p>
		<ul>
			<li>
				読み込むファイルを置くサーバと同じドメイン上に HTML ファイルを設置し、その HTML をブラウザで表示可能なこと。
				<ul>
					<li>これは自作の HTML ファイルが設置できるサービスの多くで使用可能な、簡単な導入方法です。</li>
					<li>以下の手順に従いアップロードした HTML ファイルをブラウザで開くと、ダイレクト読み込みで使用可能なリンクが表示されます。</li>
					<ol>
						<li><a href="remote.html" download="remote.html">HTML ファイル をダウンロード（右クリック保存）</a></li>
						<li>HTML ファイルをテキストエディタで開き、設定を記入</li>
						<li>読み込むファイルと同じサーバにアップロード</li>
					</ol>
				</ul>
			</li>
			<li>
				読みたいファイルの HTTP レスポンスのヘッダで Access-Control-Allow-Origin の値に「https://oov.github.io」「http://oov.github.io」「*」などが含まれていること。
				<ul>
					<li>これは主にレンタルサーバーで .htaccess や PHP などのスクリプトを使える環境の場合などに使用可能な方法です。</li>
					<li>設定方法については「Access-Control-Allow-Origin htaccess」などで検索してください。</li>
					<li>
						適切に設置できている場合 &quot;https://oov.github.io/psdtool/#load:&quot; + encodeURIComponent(設置URL) のアドレスで読み込むことができます。
						<br>読み込みたいファイルの配置場所が https ではなく http の場合、PSDTool の URL も http にする必要があります。
					</li>
				</ul>
			</li>
		</ul>
		<h2 id="original-feature">独自拡張機能</h2>
		<p>
			PSD ファイルを作る際にレイヤー名に特定の記号を付けることで、レイヤーの表示／非表示の使い勝手を改善することができます。
			<br>これらの機能を使用しても画像編集ソフトで開く際には今まで通り使用でき、編集が不便になることはありません。
			<br>また、PSDTool で読み込む場合でも<a href="#feature-options">オプションから独自拡張機能を無効化</a>することで、一般的なソフトと同じ状態で読み込むこともできます。
		</p>
		<h3 id="original-feature-asterisk">ラジオボタン化「*」</h3>
		<p><img src="img/asterisk.png" width="620" height="239" class="psdtool-thumb" alt="ラジオボタン化の使用例"></p>
		<p>
			<strong>レイヤー名の先頭に半角のアスタリスク「*」をつける</strong>と、選択項目がチェックボックスではなくラジオボタンになります。
			<br>ラジオボタンは親のグループレイヤー（画像例では「口」）に所属するようになります。
		</p>
		<ul>
			<li>グループ内でひとつのみ選択できるため、二種類の表情が同時に表示されたりするのを防ぐことができます。</li>
			<li>項目を選択すると前に選択されていた項目の選択解除も行われるため、切り替えのクリック数が半分で済みます。</li>
			<li>ラジオボタンは選択解除できませんが、親のグループレイヤーで非表示にもできます。</li>
			<li>最後にクリックしたラジオボタンはキーボードの上下キーで選択を切り替えることもできます。</li>
		</ul>
		<p>
			ラジオボタン内のレイヤーが複数表示されたまま PSD ファイルが保存されていた場合、その中で一番上のものがデフォルト表示されます。
		</p>
		<h3 id="original-feature-exclamation">強制表示化「!」</h3>
		<p><img src="img/exclamation.png" width="620" height="239" class="psdtool-thumb" alt="強制表示化の使用例"></p>
		<p>
			<strong>レイヤー名の先頭に半角のエクスクラメーションマーク「!」をつける</strong>と、選択項目からチェックボックスが消えます。
			<br>チェックボックスがない項目は表示状態になり、非表示にできなくなります。
		</p>
		<ul>
			<li>必須のパーツが外れるのを防ぐことができます。</li>
			<li>選択項目を減らせるので、使う時に迷う要素を画面から減らすことができます。</li>
			<li>ユーザーの操作で非表示にはできませんが、ZIP エクスポート機能や反転表示機能などで非表示にされることはあります。</li>
		</ul>
		<p>
			強制表示設定にしたレイヤーを非表示にして PSD ファイルを保存しても、PSDTool で表示する際は強制的に表示状態になります。
		</p>

		<h3 id="original-feature-flip">反転レイヤー指定「:flipx」「:flipy」「:flipxy」</h3>
		<p><img src="img/flip.png" width="620" height="201" class="psdtool-thumb" alt="反転レイヤー指定の使用例"></p>
		<p>
			レイヤー名の最後に「:flipx」「:flipy」「:flipxy」のいずれかをつけると、そのレイヤーはそれぞれ左右反転、上下反転、上下左右反転をしている時にだけ使用するレイヤーとして扱われます。<strong>同じ階層内に「通常表示用のレイヤー」と「反転表示用のレイヤー」の２つのレイヤーを用意し、その名前を「通常用の名前」「通常用の名前:flipx」のようにする</strong>ことで、この機能が有効化されます。
		</p>
		<p>
			例えば「体」というレイヤーを「通常用」と「左右反転用」の2種類用意する場合、それぞれの名前を「体」「体:flipx」などのようにしておきます。正しく設定すると PSDTool で読み込んだ時にレイヤー一覧から「体:flipx」が消え、「体」レイヤーを表示している状態で左右反転すると「体:flipx」の内容で自動的に表示されます。
		</p>
		<p>
			この機能はグループレイヤーで使うこともできますが、グループレイヤーで使う場合は「通常用のグループレイヤー」と「反転表示用のグループレイヤー」の中に含まれる子レイヤーの名前を完全に一致させておく必要があります。 一致していないレイヤーがある場合、その場所は正しく反転が適用されません。
		</p>
		<ul>
			<li>文字や襟など反転されるべきではない要素に対して柔軟に対処できます。</li>
			<li>「体:flipx:flipy」のように、左右反転と上下反転で同じレイヤーを使う、という使い方もできます。</li>
			<li>PSDTool のトップページから開くことができるサンプルは、この機能を利用して髪の結び目が切り替わるようになっています。</li>
		</ul>

		<h2 id="pfv-spec">PFV ファイルについて</h2>
		<p>PFV ファイルは PSDTool で登録したお気に入りの情報が格納された PSDTool 独自のファイル形式です。</p>
		<p>ファイルの実態は BOM なし UTF-8、改行コード &#x27;\n&#x27; のテキストファイルで、概ね以下の構造になっています。</p>

		<pre>[PSDToolFavorites-v1]
root-name/お気に入り

//フォルダー名/お気に入り登録名
グループ1/レイヤー1
グループ2/*グループ3

//フォルダー名/空フォルダ~folder
</pre>
		<p>まず固定のヘッダーとして必ずファイルの先頭から <code>[PSDToolFavorites-v1]</code> が現れ、行頭に <code>//</code> が現れるまではファイル全体に対する設定が続きます。<code>//</code> が現れたあとは次の <code>//</code> が現れるまでがそのお気に入りの設定です。</p>
		<p>
			日本語で書かれている箇所は実際にはそれぞれが以下の JavaScript で示す URL エンコードの亜種によりエンコードされています。 テキストエディタによる編集を容易にするためエンコードされる文字種は絞られていますが、デコードには通常の URL デコーダーが使用できます。
		</p>
		<pre>function encode(s) {
   return s.replace(/[\x00-\x1f\x22\x25\x27\x2f\x5c\x7e\x7f]/g, function(m) {
      return &#x27;%&#x27; + (&#x27;0&#x27; + m[0].charCodeAt(0).toString(16)).slice(-2);
   });
}</pre>

		<p>
			ブックマーク内に空フォルダーがある場合にはそれを示すために <code>//</code> から始まる識別子は更に後ろに <code>~folder</code> が付与される場合があります。
			<br>また、フィルターが有効になっているフォルダーがある場合は同じように <code>~filter</code> が付与され、通常のお気に入りと同じ形式でフィルタリングしない項目が列挙されます。
		</p>
		<p>
			例えば <code>//グループ1/レイヤー1</code> を解析して階層ごとに取得したい場合、まず先頭2文字を捨ててから <code>~</code> の有無を検索し、ある場合はまず <code>~</code> で分割し、後ろが <code>folder</code> など既知の識別子であるか確認し、未知の識別子の場合は次の <code>//</code> まで読み飛ばすようにしてください。これを怠ると将来識別子が追加された際に正しく処理できなくなる可能性があります（やってても互換性が維持できるかはわかりませんが…）。</p>
		</p>
		<p><code>root-name</code> にはお気に入りツリーの一番上の名前が保存されています。</p>

		<p>
			レイヤー構造に関するデータは <code>レイヤー1/レイヤー2/レイヤー3</code> のような形になっていて、この場合だと「レイヤー1」「レイヤー2」「レイヤー3」全てにチェックが入っていることを示しています。また、それぞれのレイヤー名は上記の同じ URL エンコードの亜種によりエンコードされています。
		</p>
		<p>
			しかし稀に <code>レイヤー1/レイヤー2\1/レイヤー3</code> のように　<code>\</code>　バックスラッシュ（円記号）と数字が入っていることがあり、これは PSD ファイルで同じレイヤーの階層に同じ名前のレイヤーが複数あることを示しています。<code>\</code> の後ろの数字はレイヤーの重ねあわせ順で、下から <code>0</code> から始まるインデックスで付与されていますが、<code>0</code> の場合は省略されます。
			<br>この例の場合だと、<code>レイヤー1</code> の子階層に <code>レイヤー2</code> という名前のレイヤーが複数あり、<code>レイヤー2\1</code> は下から数えて２番めの <code>レイヤー2</code> です。
			<br>レイヤー名自体に <code>\</code> が含まれている場合はエンコードによって <code>%5c</code> になっているため、<code>\</code> の存在はデコード処理の前にチェックすることで見つけることができます。
		</p>

		<h2 id="changes">変更履歴</h2>
		<dl>
			<dt>2016-05-01</dt>
			<dd>ショートカットキーからのお気に入り追加での名前のデフォルト値を最後にチェックを入れたレイヤーの名前に変更</dd>
			<dd>上下反転、左右反転で必要になるクリック数を削減</dd>
			<dd>ZIP エクスポート機能で 4GB 以上のアーカイブは ZIP64 で書き出すように改善</dd>
			<dd>シンプルビューの全パターンエクスポート機能を実装</dd>
			<dd>バグ修正</dd>
			<dt>2016-04-26</dt>
			<dd>動画へのリンクを追加</dd>
			<dt>2016-04-25</dt>
			<dd>文字コード検出処理を変更</dd>
			<dt>2016-04-22</dt>
			<dd>バグ修正</dd>
			<dt>2016-04-19</dt>
			<dd>Chrome 50 で起こる問題を回避</dd>
			<dt>2016-04-09</dt>
			<dd>反転時に自動でレイヤーを切り替える独自拡張機能を追加</dd>
			<dd>シンプルビュー機能を追加</dd>
			<dd>デザインの調整</dd>
			<dd>操作性の改善</dd>
			<dt>2016-04-08</dt>
			<dd>操作性の改善</dd>
			<dt>2016-04-04</dt>
			<dd>バグ修正</dd>
			<dt>2016-04-01</dt>
			<dd>バグ修正</dd>
			<dd>操作性の改善</dd>
			<dd>書き出しオプションの追加</dd>
			<dt>2016-03-31</dt>
			<dd>同じ階層に同じ名前のレイヤーが複数ある場合にお気に入りが使用できなかったのを修正</dd>
			<dd>フィルター機能を追加</dd>
			<dt>2016-03-22</dt>
			<dd>バグ修正</dd>
			<dt>2016-03-21</dt>
			<dd>お気に入りの ZIP エクスポート機能で 500MB の容量上限を撤廃</dd>
			<dt>2016-03-18</dt>
			<dd>バグ修正</dd>
			<dt>2016-03-17</dt>
			<dd>バグ修正</dd>
			<dt>2016-03-16</dt>
			<dd>ファイル読み込みとキャンバス作成を並列化</dd>
			<dt>2016-03-10</dt>
			<dd>バグ修正</dd>
			<dt>2016-03-06</dt>
			<dd>お気に入り機能を追加</dd>
			<dd>連番ダウンロードで番号の省略を可能にした</dd>
			<dd>デザインの調整</dd>
			<dd>ドキュメントを整理</dd>
			<dd>左カラムの幅をドラッグで変えられるように</dd>
			<dd>縮小と連番ダウンロードに全角数字を入れても認識するように</dd>
			<dd>巨大な ZIP ファイル（1GB以上）からの読み込みに対応</dd>
			<dt>2016-02-18</dt>
			<dd>オプション「自動トリミング」「独自機能を無効化」を追加</dd>
			<dt>2016-02-17</dt>
			<dd>操作性の改善</dd>
			<dd>バグ修正</dd>
			<dt>2016-02-15</dt>
			<dd>バグ修正</dd>
			<dt>2016-02-07</dt>
			<dd>バグ修正</dd>
			<dt>2016-02-06</dt>
			<dd>縮小のサイズ計算が誤っていたのを修正</dd>
			<dd>ZIP ファイルを開いた時はテキストファイルを表示できる機能を追加</dd>
			<dd>ダイレクト読み込み機能を追加</dd>
			<dt>2016-02-05</dt>
			<dd>ZIP 圧縮された PSD ファイルの読み込みに対応</dd>
			<dt>2016-02-04</dt>
			<dd>合成モード「通過（グループレイヤーのみ）」「通常」「比較（暗）」「乗算」「焼き込みカラー」「焼き込み（リニア）」「カラー比較（暗）」「比較（明）」「スクリーン」「覆い焼きカラー」「覆い焼き（リニア）」「カラー比較（明）」「オーバーレイ」「ソフトライト」「ハードライト」「ビビッドライト」「リニアライト」「ピンライト」「ハードミックス」「差の絶対値」「除外」「減算」「除算」「色相」「彩度」「カラー」「輝度」の実装を追加</dd>
			<dt>2016-02-02</dt>
			<dd>操作性の改善</dd>
			<dt>2016-02-01</dt>
			<dd>描画負荷の軽減</dd>
			<dd>縮小処理中にUIが硬直しないように</dd>
			<dt>2016-01-29</dt>
			<dd>透過領域でアニメーション</dd>
			<dd>縮小機能を追加</dd>
			<dd>連番ダウンロード機能を追加</dd>
			<dd>バグ修正</dd>
			<dt>2016-01-28</dt>
			<dd>合成モード「覆い焼き（リニア）」に対応</dd>
			<dd>レイヤーマスク、ベクトルマスクに対応</dd>
			<dd>バグ修正</dd>
			<dt>2016-01-26</dt>
			<dd>クリッピングマスクに対応</dd>
			<dd>読み込み状況の進捗表示</dd>
			<dd>バグ修正</dd>
			<dt>2016-01-22</dt>
			<dd>初版</dd>
		</dl>

		<div class="well text-center">
			<small>
				Created by <a href="https://github.com/oov/psdtool" target="_blank">oov</a> | Powered by <a href="http://www.gopherjs.org/" target="_blank">GopherJS</a> | Please use a <a href="https://whatbrowser.org/" target="_blank">modern browser</a> | Please listen to <a href="https://www.youtube.com/watch?v=SldjqJz3thA" target="_blank">my song</a>
			</small>
		</div>
	</div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha256-KXn5puMvxCw+dAYznun+drMdG1IFl3agK0p/pqT9KAo= sha512-2e8qq0ETcfWRI4HJBzQiA3UoyFk6tbNyG+qSaIBZLyW9Xf3sWZHN/lxe9fTh1U45DpPf07yj94KsUHHWe4Yk1A==" crossorigin="anonymous"></script>
</body>

</html>
